<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Stop Midnight Task Viewer</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='256' height='256'%3E%3Crect width='256' height='256' rx='48' fill='%231f6feb'/%3E%3Ctext x='50%' y='54%' dominant-baseline='middle' text-anchor='middle' font-family='Segoe UI,Roboto,Arial' font-size='120' fill='white'%3E‚úì%3C/text%3E%3C/svg%3E"/>
    <script>
      (function() {
        try {
          var stored = localStorage.getItem('theme');
          var preferDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
          var theme = stored || (preferDark ? 'dark' : 'light');
          document.documentElement.setAttribute('data-theme', theme);
        } catch (e) {}
      })();
    </script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>üìã <span id="app-title">Stop Midnight Task Viewer</span></h1>
        <div class="search-container">
            <input type="text" id="search-box" class="search-box" placeholder="„Çø„Çπ„ÇØ„ÇíÊ§úÁ¥¢...">
            <button id="search-mode-toggle" class="search-mode-toggle">üîé „Çø„Ç§„Éà„É´Ê§úÁ¥¢</button>
            <button id="manual-refresh-btn" class="search-mode-toggle" title="‰∏ÄË¶ß„ÇíÂÜçË™≠Ëæº">üîÑ ÂÜçË™≠Ëæº</button>
            <button id="settings-toggle" class="search-mode-toggle" title="Ë®≠ÂÆö">‚öôÔ∏è Ë®≠ÂÆö</button>
            <button id="history-toggle" class="search-mode-toggle" title="Â§âÊõ¥Â±•Ê≠¥">üïí Â±•Ê≠¥</button>
            <button id="new-task-toggle" class="search-mode-toggle" title="Êñ∞Ë¶è„Çø„Çπ„ÇØ">Ôºã Êñ∞Ë¶è</button>
        </div>
        <div class="header-stats">
            <div id="total-count" class="total-count"></div>
            <div class="update-time">Êõ¥Êñ∞: <span id="last-update">--:--</span></div>
        </div>
    </header>
    
    <div id="search-results" class="search-results"></div>
    
    <main>
        <div class="status-column" id="backlog-section">
            <div class="status-header">
                <span class="status-badge">BACKLOG</span>
                <span class="status-count" id="backlog-count">0</span>
            </div>
            <div class="task-list" id="backlog-list"></div>
        </div>
        
        <div class="status-column" id="todo-section">
            <div class="status-header">
                <span class="status-badge">TODO</span>
                <span class="status-count" id="todo-count">0</span>
            </div>
            <div class="task-list" id="todo-list"></div>
        </div>
        
        <div class="status-column" id="review-section">
            <div class="status-header">
                <span class="status-badge">REVIEW</span>
                <span class="status-count" id="review-count">0</span>
            </div>
            <div class="task-list" id="review-list"></div>
        </div>
        
        <div class="status-column" id="done-section">
            <div class="status-header">
                <span class="status-badge">DONE</span>
                <span class="status-count" id="done-count">0</span>
            </div>
            <div class="task-list" id="done-list"></div>
        </div>
    </main>
    
    <div id="task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title"></h2>
                <button class="modal-close" aria-label="Èñâ„Åò„Çã" title="Èñâ„Åò„Çã">&times;</button>
            </div>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>
    <div id="toast" class="toast" role="status" aria-live="polite"></div>
    <!-- DnD„Çπ„Éó„É©„ÉÉ„Ç∑„É•ÔºàÂ§ß„Åç„Åè3ÁßíË°®Á§∫Ôºâ -->
    <div id="status-splash" aria-live="polite" aria-atomic="true">
        <div class="status-splash-content" id="status-splash-content"></div>
    </div>
    <div id="activity-modal" class="modal" aria-modal="true" role="dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Â§âÊõ¥Â±•Ê≠¥</h2>
                <button class="activity-modal-close" aria-label="Èñâ„Åò„Çã" title="Èñâ„Åò„Çã">&times;</button>
            </div>
            <div class="modal-body">
                <div id="activity-list" class="activity-list"></div>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal" aria-modal="true" role="dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Ë®≠ÂÆö</h2>
                <button class="settings-close" aria-label="Èñâ„Åò„Çã" title="Èñâ„Åò„Çã">&times;</button>
            </div>
            <div class="modal-body">
                <div class="edit-form">
                    <div style="margin:10px 0;">
                        <label>„Éò„ÉÉ„ÉÄ„Éº„Çø„Ç§„Éà„É´</label>
                        <input id="settings-title" type="text" placeholder="Stop Midnight Task Viewer" />
                    </div>
                    <div style="margin:10px 0;">
                        <label>„ÅÇ„Å™„Åü„ÅÆÂêçÂâç</label>
                        <input id="settings-author-name" type="text" placeholder="Ë°®Á§∫Âêç" />
                    </div>
                    <div style="margin:10px 0;">
                        <label>„ÉÜ„Éº„Éû</label>
                        <div style="display:flex; gap:8px; margin-top:6px;">
                            <button id="settings-theme-toggle" class="btn">Âàá„ÇäÊõø„Åà</button>
                            <span id="settings-theme-label" style="align-self:center;color:var(--muted);"></span>
                        </div>
                    </div>
                    <div class="modal-toolbar" style="justify-content:flex-end;padding:0;">
                        <button id="settings-apply" class="btn btn-primary">ÈÅ©Áî®</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="new-task-modal" class="modal" aria-modal="true" role="dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Êñ∞Ë¶è„Çø„Çπ„ÇØ</h2>
                <button class="new-task-close" aria-label="Èñâ„Åò„Çã" title="Èñâ„Åò„Çã">&times;</button>
            </div>
            <div class="modal-body">
                <div class="edit-form">
                    <div style="margin:10px 0; display:flex; gap:8px; align-items:center;">
                        <label>„ÉÜ„É≥„Éó„É¨„Éº„Éà</label>
                        <select id="new-task-template" class="search-mode-toggle" style="min-width: 160px;">
                            <option value="custom">„Ç´„Çπ„Çø„É†</option>
                        </select>
                        <button id="new-task-apply-template" class="btn" title="„ÉÜ„É≥„Éó„É¨„ÇíÂÜçÈÅ©Áî®ÔºàÊú¨Êñá„ÇíÁΩÆÊèõÔºâ">ÂÜçÈÅ©Áî®</button>
                    </div>
                    <div style="margin:10px 0;">
                        <label>„Çø„Ç§„Éà„É´</label>
                        <input id="new-task-title" type="text" placeholder="„Çø„Çπ„ÇØÂêç" />
                    </div>
                    <div style="margin:10px 0;">
                        <label>Êú¨ÊñáÔºà‰ªªÊÑèÔºâ</label>
                        <textarea id="new-task-body" placeholder="Êú¨Êñá"></textarea>
                    </div>
                    <div style="margin:10px 0;">
                        <label>„Çπ„ÉÜ„Éº„Çø„Çπ</label>
                        <select id="new-task-status" class="search-mode-toggle">
                            <option value="todo">TODO</option>
                            <option value="backlog">BACKLOG</option>
                            <option value="review">REVIEW</option>
                            <option value="done">DONE</option>
                        </select>
                    </div>
                    <div class="modal-actions">
                        <button id="new-task-save" class="btn btn-primary">‰ΩúÊàê</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- footer removed: ÈùûÊ©üËÉΩ„É™„É≥„ÇØ„ÇíÊí§ÂéªÔºà‰ªäÂæå„ÄÅÊ©üËÉΩ„Éú„Çø„É≥„ÇíÂÆüË£Ö‰∫àÂÆöÔºâ -->
    
    <script src="viewer.js"></script>
</body>
</html>
